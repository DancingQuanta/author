#!/usr/bin/env bash
# ****************************************************
#
#   md2word
#
#   Convert markdown to word with pandoc
#
# ----------------------------------------------------
#   Dependencies
# ----------------------------------------------------
#
#   pandoc
#
# ----------------------------------------------------
#   Usage
# ----------------------------------------------------
#
#  `md2word file.md`
#
# ****************************************************

# Error handling

set -o errexit
set -o nounset
set -o pipefail

# ----------------------------------------------------
#   Variables
# ----------------------------------------------------

# ----------------------------------------------------
#   Functions
# ----------------------------------------------------

md2word() {
	if [ -f $1 ]; then
		filename=$(basename "$1")
		extension="${filename##*.}"
		filename="${filename%.*}"
		if [ "$extension" == "md" ]; then
			pandoc -s $1 -o "$filename.docx"
		else
			echo "$1 is a wrong file type"
		fi
	else
		echo "$1 does not exist"
	fi
}

# ----------------------------------------------------
#   Main
# ----------------------------------------------------

# MAIN
md2word $1
